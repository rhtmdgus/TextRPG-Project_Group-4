#include <stdio.h>
#include <conio.h>
#include <stdlib.h>
#include "jobselect.h"
#include "player.h"
#include "log.h"


void jobSelect_screen()
{
    // 화면 중앙에 맞추기 위해 여백 줄 추가
    for (int i = 0; i < (MAP_HEIGHT - 20) / 2; i++)
        printf("\n");

    // 중앙 정렬 및 게임 소개 텍스트
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("====================================================================\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||                      직  업  선  택                            ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("====================================================================\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("         본인이 선호하는 무기를 다루는 직업을 선택하세요\n\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("           숫자키로 선택을 합니다\n\n");

    // 조작키 설명 섹션
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("====================================================================\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||1. 검사                                                         ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("|| -공격적인 직업으로, 공격력 위주로 스탯이 증가합니다            ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||2. 궁수                                                         ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||-원거리에서 공격하는 직업으로, 치명타 위주로 스탯이 증가합니다  ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("|| 3. 창병                                                        ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||-균형잡힌 직업으로, 전 스탯이 균등하게 증가합니다               ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("|| 4. 방패병                                                      ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("||-보호를 우선으로 하는 직업으로, 방어력 위주로 스탯이 증가합니다 ||\n");
    for (int j = 0; j < (MAP_WIDTH - 57) / 2; j++)
        printf(" ");
    printf("====================================================================\n");
   
    jobSelect();

}

void jobSelect()
{
    int num;
    char action;
    while(1)
    {
        num = _getch();
        switch (num)
        {
        case '1':
            setCursorPosition(23, 23);
            printf("%-70s", "검사를 선택하셨습니다.");
            setCursorPosition(23, 24);
            printf("%-70s", "확정이시면 a버튼을 눌러주세요");
            action = _getch();
            if (action == 'a' || action == 'A')
            {
                //플레이어 스텟 변경
                player.job = 1;
                player.attack = 4;
                player.defense = 2;
                player.accuracy = 1;
                updateLog("검사를 선택하셨습니다.");
                return;
            }
            break;

        case '2':
            setCursorPosition(23, 23);
            printf("%-70s", "궁수를 선택하셨습니다.");
            setCursorPosition(23, 24);
            printf("%-70s", "확정이시면 a버튼을 눌러주세요");
            action = _getch();
            if (action == 'a' || action == 'A')
            {
                //플레이어 스텟 변경
                player.job = 2;
                player.attack = 2;
                player.defense = 2;
                player.accuracy = 3;
                updateLog("궁수를 선택하셨습니다.");
                return;
            }
            break;
        case '3':
            setCursorPosition(23, 23);
            printf("%-70s", "창병을 선택하셨습니다.");
            setCursorPosition(23, 24);
            printf("%-70s", "확정이시면 a버튼을 눌러주세요");
            action = _getch();
            if (action == 'a' || action == 'A')
            {
                //플레이어 스텟 변경
                player.job = 3;
                player.attack = 2;
                player.defense = 2;
                player.accuracy = 2;
                updateLog("창병을 선택하셨습니다.");
                return;
            }
            break;
        case '4':
            setCursorPosition(23, 23);
            printf("%-70s", "방패병을 선택하셨습니다.");
            setCursorPosition(23, 24);
            printf("%-70s", "확정이시면 a버튼을 눌러주세요");
            action = _getch();
            if (action == 'a' || action == 'A')
            {
                //플레이어 스텟 변경
                player.job = 4;
                player.attack = 2;
                player.defense = 4;
                player.accuracy = 1;
                updateLog("방패병을 선택하셨습니다.");
                return;
            }
            break;
        }
    }
}